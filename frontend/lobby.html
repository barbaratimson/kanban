<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanban</title>
    <script src="lib/code.jquery.com_jquery-3.7.0.min.js"></script>
    <script src="lib/jquery.extention.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
        <div class="center-menu-container">
            <div class="center-menu">
                <div>
                <button class="left-button" id = "connect-button">CONNECT</button>
                 </div>
                <button class="right-button" id = "create-button">CREATE</button>
        </div>
    </div>
</body>

<script>
let roomId = $.getUserRoom()
let user = $.getUserData()
if (!user) {
    window.location.assign("./login.html")
} 
if (roomId){
    roomId = roomId.roomId
}

    $("#connect-button").on('click', function(e){
        let roomIdConnect = prompt("Connect",roomId)
        let password = prompt("password")
        localStorage.setItem("roomPassword",password)
        if (roomIdConnect.length === 13){
        window.location.assign(`./index.html?roomId=${roomIdConnect}`)
        } 

})
if (roomId){
    $("#create-button").css("display","none")

} else {
    $("#create-button").on('click', function(e){
    let roomId = Date.now()
    let password = prompt("Pick a password")
    $.ajax({
            url: "http://localhost/room/create",
            data:JSON.stringify({roomId:roomId,password:password}),  
            method:"POST",
            headers: { 'Authorization': `Bearer ${localStorage.getItem("token")}` },
         }).done(function(data){
            console.log(data)
             window.location.assign(`./index.html?roomId=${roomId}`)

         });
        })
}

</script>
</html>