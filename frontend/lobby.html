<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanban</title>
    <script src="lib/code.jquery.com_jquery-3.7.0.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
        <div class="center-menu-container">
            <div class="center-menu">
                <button class="left-button" id = "connect-button">CONNECT</button>
                <button class="right-button" id = "create-button">CREATE</button>
        </div>
    </div>
</body>

<script>
    jQuery.extend({
    getRoom: function() {
        var result = null;
        $.ajax({
            url: "http://localhost/room",
            method:"GET",
            async:false,
            headers: { 'Authorization': `Bearer ${localStorage.getItem("token")}` },
            success: function(data) {
                result = data;
            }
        });
       return result;
    }
});

let roomId = $.getRoom().roomId

    $("#connect-button").on('click', function(e){
        let roomIdConnect = prompt("Connect",roomId)
        if (roomIdConnect.length === 13){
        window.location.assign(`http://127.0.0.1:5501/frontend/index.html?roomId=${roomIdConnect}`)
        } 

})
if (roomId){
    $("#create-button").css("display","none")

} else {
    $("#create-button").on('click', function(e){
    let roomId = Date.now()
    $.ajax({
            url: "http://localhost/room/create",
            data:JSON.stringify({roomId:roomId}),  
            method:"POST",
            headers: { 'Authorization': `Bearer ${localStorage.getItem("token")}` },
         }).done(function(data){
            console.log(data)
             window.location.assign(`http://127.0.0.1:5501/frontend/index.html?roomId=${roomIdConnect}`)
         });
        })
}

</script>
</html>